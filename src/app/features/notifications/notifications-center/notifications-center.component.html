<div class="flex min-h-screen bg-gray-50">
  <app-sidebar></app-sidebar>
  <div class="flex-1 mr-64">
    <app-topbar></app-topbar>

    <main class="p-6">
      <!-- Header -->
      <div class="flex justify-between items-center mb-6">
        <div>
          <h1 class="text-3xl font-bold text-gray-800 mb-2">ุงูุฅุดุนุงุฑุงุช ๐</h1>
          <p class="text-gray-600">ุฌููุน ุงูุชุญุฏูุซุงุช ูุงูุฅุดุนุงุฑุงุช ุงููุงูุฉ</p>
        </div>
        <button
          *ngIf="stats.unread > 0"
          (click)="markAllAsRead()"
          class="btn-primary flex items-center gap-2"
        >
          <span>โ</span>
          <span>ุชุญุฏูุฏ ุงููู ูููุฑูุก</span>
        </button>
      </div>

      <!-- Statistics Cards -->
      <div class="grid grid-cols-2 md:grid-cols-6 gap-4 mb-6">
        <app-card>
          <div class="text-center">
            <div class="text-2xl mb-1">๐ข</div>
            <p class="text-xs text-gray-600 mb-1">ุงูุฅุฌูุงูู</p>
            <p class="text-xl font-bold text-gray-800">{{ stats.total }}</p>
          </div>
        </app-card>

        <app-card class="bg-blue-50 border-blue-200">
          <div class="text-center">
            <div class="text-2xl mb-1">๐ต</div>
            <p class="text-xs text-gray-600 mb-1">ุบูุฑ ููุฑูุกุฉ</p>
            <p class="text-xl font-bold text-blue-600">{{ stats.unread }}</p>
          </div>
        </app-card>

        <app-card>
          <div class="text-center">
            <div class="text-2xl mb-1">โน๏ธ</div>
            <p class="text-xs text-gray-600 mb-1">ูุนูููุงุช</p>
            <p class="text-xl font-bold text-blue-600">{{ stats.info }}</p>
          </div>
        </app-card>

        <app-card>
          <div class="text-center">
            <div class="text-2xl mb-1">โ๏ธ</div>
            <p class="text-xs text-gray-600 mb-1">ุชุญุฐูุฑุงุช</p>
            <p class="text-xl font-bold text-yellow-600">{{ stats.warning }}</p>
          </div>
        </app-card>

        <app-card>
          <div class="text-center">
            <div class="text-2xl mb-1">โ</div>
            <p class="text-xs text-gray-600 mb-1">ูุฌุงุญ</p>
            <p class="text-xl font-bold text-green-600">{{ stats.success }}</p>
          </div>
        </app-card>

        <app-card>
          <div class="text-center">
            <div class="text-2xl mb-1">โ</div>
            <p class="text-xs text-gray-600 mb-1">ุฃุฎุทุงุก</p>
            <p class="text-xl font-bold text-red-600">{{ stats.error }}</p>
          </div>
        </app-card>
      </div>

      <!-- Filters -->
      <app-card class="mb-6">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div>
            <label class="label">ููุน ุงูุฅุดุนุงุฑ</label>
            <select
              [(ngModel)]="selectedType"
              (change)="applyFilters()"
              class="input-field"
            >
              <option value="">ุฌููุน ุงูุฃููุงุน</option>
              <option value="info">ูุนูููุงุช</option>
              <option value="warning">ุชุญุฐูุฑ</option>
              <option value="success">ูุฌุงุญ</option>
              <option value="error">ุฎุทุฃ</option>
            </select>
          </div>

          <div class="flex items-end">
            <label class="flex items-center gap-2 cursor-pointer">
              <input
                type="checkbox"
                [(ngModel)]="showUnreadOnly"
                (change)="applyFilters()"
                class="w-4 h-4 text-primary-600 rounded focus:ring-primary-500"
              />
              <span class="text-sm text-gray-700">ุบูุฑ ุงูููุฑูุกุฉ ููุท</span>
            </label>
          </div>

          <div class="md:col-span-2 flex items-end">
            <button (click)="clearFilters()" class="btn-secondary w-full">
              ูุณุญ ุงูููุงุชุฑ
            </button>
          </div>
        </div>
      </app-card>

      <!-- Loading State -->
      <div *ngIf="loading" class="flex justify-center items-center py-12">
        <app-loader></app-loader>
      </div>

      <!-- Notifications List -->
      <div *ngIf="!loading" class="space-y-3">
        <app-card
          *ngFor="let notification of filteredNotifications"
          [ngClass]="{
            'bg-blue-50 border-r-4 border-blue-500': !notification.isRead,
            'hover:shadow-md': true
          }"
          class="transition cursor-pointer"
        >
          <div class="flex items-start gap-4">
            <!-- Icon -->
            <div
              class="w-12 h-12 rounded-full flex items-center justify-center flex-shrink-0"
              [ngClass]="{
                'bg-blue-100': notification.type === 'info',
                'bg-yellow-100': notification.type === 'warning',
                'bg-green-100': notification.type === 'success',
                'bg-red-100': notification.type === 'error'
              }"
            >
              <span class="text-2xl">{{ getTypeIcon(notification.type) }}</span>
            </div>

            <!-- Content -->
            <div class="flex-1 min-w-0">
              <div class="flex items-start justify-between gap-2 mb-2">
                <div class="flex items-center gap-2">
                  <h3 class="font-semibold text-gray-800">
                    {{ notification.title }}
                  </h3>
                  <app-badge
                    *ngIf="!notification.isRead"
                    [variant]="'info'"
                    class="text-xs"
                  >
                    ุฌุฏูุฏ
                  </app-badge>
                </div>
                <span class="text-xs text-gray-500 whitespace-nowrap">
                  {{ getRelativeTime(notification.createdAt) }}
                </span>
              </div>

              <p class="text-sm text-gray-600 mb-3">
                {{ notification.message }}
              </p>

              <!-- Action Link -->
              <div *ngIf="notification.actionUrl" class="mb-2">
                <a
                  [href]="notification.actionUrl"
                  class="text-sm text-primary-600 hover:text-primary-700 font-medium inline-flex items-center gap-1"
                >
                  {{ notification.actionText || "ุนุฑุถ ุงูุชูุงุตูู" }}
                  <span>โ</span>
                </a>
              </div>

              <!-- Footer -->
              <div
                class="flex items-center justify-between pt-2 border-t border-gray-200"
              >
                <div class="flex items-center gap-2">
                  <app-badge [variant]="getTypeColor(notification.type)">
                    {{
                      notification.type === "info"
                        ? "ูุนูููุงุช"
                        : notification.type === "warning"
                        ? "ุชุญุฐูุฑ"
                        : notification.type === "success"
                        ? "ูุฌุงุญ"
                        : "ุฎุทุฃ"
                    }}
                  </app-badge>
                  <span class="text-xs text-gray-500">
                    {{ notification.createdAt | date : "dd/MM/yyyy HH:mm" }}
                  </span>
                </div>

                <button
                  *ngIf="!notification.isRead"
                  (click)="markAsRead(notification.id)"
                  class="text-xs text-primary-600 hover:text-primary-700 font-medium flex items-center gap-1"
                >
                  <span>โ</span>
                  <span>ุชุญุฏูุฏ ูููุฑูุก</span>
                </button>
              </div>
            </div>
          </div>
        </app-card>

        <!-- Empty State -->
        <div
          *ngIf="filteredNotifications.length === 0"
          class="text-center py-12"
        >
          <div class="text-gray-400 text-6xl mb-4">๐</div>
          <h3 class="text-xl font-semibold text-gray-700 mb-2">
            ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช
          </h3>
          <p class="text-gray-500">
            {{
              showUnreadOnly || selectedType
                ? "ุฌุฑุจ ุชุบููุฑ ูุนุงููุฑ ุงูุจุญุซ"
                : "ูุง ุชูุฌุฏ ุฅุดุนุงุฑุงุช ุฌุฏูุฏุฉ"
            }}
          </p>
        </div>
      </div>

      <!-- Summary Footer -->
      <div *ngIf="!loading && filteredNotifications.length > 0" class="mt-6">
        <app-card>
          <div class="flex justify-between items-center">
            <p class="text-gray-600">
              ุนุฑุถ
              <span class="font-semibold">{{
                filteredNotifications.length
              }}</span>
              ูู
              <span class="font-semibold">{{ notifications.length }}</span>
              ุฅุดุนุงุฑ
            </p>
            <p class="text-sm text-gray-500">
              <span class="font-semibold text-blue-600">{{
                stats.unread
              }}</span>
              ุฅุดุนุงุฑ ุบูุฑ ููุฑูุก
            </p>
          </div>
        </app-card>
      </div>
    </main>
  </div>
</div>
