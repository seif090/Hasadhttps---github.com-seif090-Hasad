<!-- ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø±Ø¶ -->
<div class="flex min-h-screen bg-gray-50">
  <app-sidebar></app-sidebar>

  <div class="flex-1 mr-64">
    <app-topbar></app-topbar>

    <main class="p-6">
      <!-- Loader -->
      <app-loader *ngIf="isLoading"></app-loader>

      <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
      <div *ngIf="!isLoading && land">
        <!-- Ø§Ù„Ø¹ÙˆØ¯Ø© -->
        <button
          routerLink="/farmer/lands"
          class="mb-4 flex items-center gap-2 text-gray-600 hover:text-primary-600 transition"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 19l-7-7 7-7"
            />
          </svg>
          <span>Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø±Ø§Ø¶ÙŠ</span>
        </button>

        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø±Ø¶ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
        <div class="card mb-6">
          <div class="flex items-start justify-between mb-6">
            <div>
              <h1 class="text-3xl font-bold text-gray-800 mb-2">
                Ø£Ø±Ø¶ {{ land.location.village }}
              </h1>
              <p class="text-gray-600">
                {{ land.location.governorate }} - {{ land.location.district }}
              </p>
            </div>
            <app-badge [variant]="'success'">{{ land.status }}</app-badge>
          </div>

          <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
            <div>
              <p class="text-sm text-gray-600 mb-1">Ø§Ù„Ù…Ø³Ø§Ø­Ø©</p>
              <p class="text-2xl font-bold text-gray-800">
                {{ land.area }} ÙØ¯Ø§Ù†
              </p>
            </div>
            <div>
              <p class="text-sm text-gray-600 mb-1">Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø©</p>
              <p class="text-xl font-semibold text-gray-800">
                {{ land.soilType }}
              </p>
            </div>
            <div>
              <p class="text-sm text-gray-600 mb-1">Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</p>
              <p class="text-xl font-semibold text-gray-800">
                {{ land.irrigationType }}
              </p>
            </div>
            <div *ngIf="land.currentCrop">
              <p class="text-sm text-gray-600 mb-1">Ø§Ù„Ù…Ø­ØµÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ</p>
              <p class="text-xl font-semibold text-gray-800">
                {{ land.currentCrop }}
              </p>
            </div>
          </div>
        </div>

        <!-- Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
        <div class="mb-6">
          <div class="border-b border-gray-200">
            <nav class="flex gap-6">
              <button
                (click)="setActiveTab('details')"
                [class.text-primary-600]="activeTab === 'details'"
                [class.border-primary-600]="activeTab === 'details'"
                [class.text-gray-600]="activeTab !== 'details'"
                class="pb-3 border-b-2 font-medium transition"
              >
                Ø§Ù„ØªÙØ§ØµÙŠÙ„
              </button>
              <button
                (click)="setActiveTab('crops')"
                [class.text-primary-600]="activeTab === 'crops'"
                [class.border-primary-600]="activeTab === 'crops'"
                [class.text-gray-600]="activeTab !== 'crops'"
                class="pb-3 border-b-2 font-medium transition"
              >
                Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ© ({{ cropCycles.length }})
              </button>
              <button
                (click)="setActiveTab('harvests')"
                [class.text-primary-600]="activeTab === 'harvests'"
                [class.border-primary-600]="activeTab === 'harvests'"
                [class.text-gray-600]="activeTab !== 'harvests'"
                class="pb-3 border-b-2 font-medium transition"
              >
                Ø§Ù„Ø­ØµØ§Ø¯ ({{ harvests.length }})
              </button>
              <button
                (click)="setActiveTab('contracts')"
                [class.text-primary-600]="activeTab === 'contracts'"
                [class.border-primary-600]="activeTab === 'contracts'"
                [class.text-gray-600]="activeTab !== 'contracts'"
                class="pb-3 border-b-2 font-medium transition"
              >
                Ø§Ù„Ø¹Ù‚ÙˆØ¯ ({{ land.contracts.length }})
              </button>
            </nav>
          </div>
        </div>

        <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
        <div>
          <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªÙØ§ØµÙŠÙ„ -->
          <div *ngIf="activeTab === 'details'">
            <div class="card">
              <h3 class="text-xl font-bold text-gray-800 mb-4">
                Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙØµÙ„Ø©
              </h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                  <div>
                    <p class="text-sm text-gray-600 mb-1">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</p>
                    <p class="text-lg font-semibold text-gray-800">
                      {{ land.location.governorate }}
                    </p>
                  </div>
                  <div>
                    <p class="text-sm text-gray-600 mb-1">Ø§Ù„Ù…Ø±ÙƒØ²</p>
                    <p class="text-lg font-semibold text-gray-800">
                      {{ land.location.district }}
                    </p>
                  </div>
                  <div>
                    <p class="text-sm text-gray-600 mb-1">Ø§Ù„Ù‚Ø±ÙŠØ©</p>
                    <p class="text-lg font-semibold text-gray-800">
                      {{ land.location.village }}
                    </p>
                  </div>
                </div>
                <div class="space-y-4">
                  <div>
                    <p class="text-sm text-gray-600 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø¶Ø§ÙØ©</p>
                    <p class="text-lg font-semibold text-gray-800">
                      {{ land.createdAt | date : "dd/MM/yyyy" }}
                    </p>
                  </div>
                  <div>
                    <p class="text-sm text-gray-600 mb-1">Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</p>
                    <p class="text-lg font-semibold text-gray-800">
                      {{ land.updatedAt | date : "dd/MM/yyyy" }}
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ© -->
          <div *ngIf="activeTab === 'crops'">
            <div *ngIf="cropCycles.length === 0" class="card text-center py-12">
              <span class="text-6xl mb-4 block">ğŸŒ±</span>
              <h3 class="text-xl font-semibold text-gray-800 mb-2">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙˆØ±Ø§Øª Ø²Ø±Ø§Ø¹ÙŠØ©
              </h3>
            </div>

            <div *ngIf="cropCycles.length > 0" class="space-y-4">
              <div *ngFor="let cycle of cropCycles" class="card">
                <div class="flex items-start justify-between mb-4">
                  <div>
                    <h3 class="text-lg font-bold text-gray-800">
                      {{ cycle.cropType }}
                    </h3>
                    <p class="text-sm text-gray-600">Ù…ÙˆØ³Ù… {{ cycle.season }}</p>
                  </div>
                  <app-badge [variant]="getCycleStatusColor(cycle.status)">
                    {{ cycle.status }}
                  </app-badge>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                  <div>
                    <p class="text-gray-600">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²Ø±Ø§Ø¹Ø©</p>
                    <p class="font-semibold">
                      {{ cycle.plantingDate | date : "dd/MM/yyyy" }}
                    </p>
                  </div>
                  <div>
                    <p class="text-gray-600">Ø§Ù„Ø­ØµØ§Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</p>
                    <p class="font-semibold">
                      {{ cycle.expectedHarvestDate | date : "dd/MM/yyyy" }}
                    </p>
                  </div>
                  <div>
                    <p class="text-gray-600">Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹</p>
                    <p class="font-semibold">{{ cycle.expectedYield }} Ø·Ù†</p>
                  </div>
                  <div>
                    <p class="text-gray-600">Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ</p>
                    <p class="font-semibold">{{ cycle.expenses }} Ø¬Ù†ÙŠÙ‡</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø­ØµØ§Ø¯ -->
          <div *ngIf="activeTab === 'harvests'">
            <div *ngIf="harvests.length === 0" class="card text-center py-12">
              <span class="text-6xl mb-4 block">ğŸŒ¾</span>
              <h3 class="text-xl font-semibold text-gray-800 mb-2">
                Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø­ØµØ§Ø¯
              </h3>
            </div>

            <div *ngIf="harvests.length > 0" class="space-y-4">
              <div *ngFor="let harvest of harvests" class="card">
                <div class="flex items-start justify-between mb-4">
                  <div>
                    <h3 class="text-lg font-bold text-gray-800">
                      {{ harvest.date | date : "dd/MM/yyyy" }}
                    </h3>
                    <p class="text-sm text-gray-600">
                      Ø§Ù„ÙƒÙ…ÙŠØ©: {{ harvest.quantity }} Ø·Ù†
                    </p>
                  </div>
                  <app-badge [variant]="getQualityColor(harvest.quality)">
                    Ø¬ÙˆØ¯Ø© {{ harvest.quality }}
                  </app-badge>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                  <div>
                    <p class="text-gray-600">Ø§Ù„Ø³Ø¹Ø±/Ø·Ù†</p>
                    <p class="font-semibold">{{ harvest.price }} Ø¬Ù†ÙŠÙ‡</p>
                  </div>
                  <div>
                    <p class="text-gray-600">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</p>
                    <p class="font-semibold text-green-600">
                      {{ harvest.totalRevenue }} Ø¬Ù†ÙŠÙ‡
                    </p>
                  </div>
                  <div *ngIf="harvest.buyer">
                    <p class="text-gray-600">Ø§Ù„Ù…Ø´ØªØ±ÙŠ</p>
                    <p class="font-semibold">{{ harvest.buyer }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¹Ù‚ÙˆØ¯ -->
          <div *ngIf="activeTab === 'contracts'">
            <div
              *ngIf="land.contracts.length === 0"
              class="card text-center py-12"
            >
              <span class="text-6xl mb-4 block">ğŸ“„</span>
              <h3 class="text-xl font-semibold text-gray-800 mb-2">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚ÙˆØ¯
              </h3>
            </div>

            <div *ngIf="land.contracts.length > 0" class="space-y-4">
              <div class="card">
                <p class="text-gray-600">
                  Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù‚ÙˆØ¯ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø±Ø¶:
                  <strong>{{ land.contracts.length }}</strong>
                </p>
                <a
                  routerLink="/contracts"
                  class="text-primary-600 hover:text-primary-700 font-medium mt-2 inline-block"
                >
                  Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù‚ÙˆØ¯ â†
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>
